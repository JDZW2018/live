<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <base target="_self" href="http://192.168.1.108:90/ws_project/jiaotouxueyuan/">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,initial-scale=1.0, user-scalable=no" />
    <link href="css/reset.css" rel="stylesheet" type="text/css"/>
    <link href="css/videoCourseList.css" rel="stylesheet" type="text/css"/>
    <script src="js/conform.js" type="text/javascript"></script>
    <script src="js/iScroll-5.1.2.js"></script>
    <!--<script src="js/iscroll-probe.js"></script>-->
    <title>视频</title>
    <style>

    </style>
</head>
<body>
<nav class="nav">
    <div id="wrapper">
        <div id="scroller">
            <ul class="category_nav">
                <li class=""><a>免费学院1</a></li>
                <li class="active" ><a>创业学院22</a></li>
                <li><a>管理学院333</a></li>
                <li><a>父母学院4444</a></li>
                <li><a>免费学院55555</a></li>
                <li><a>免费学院666666</a></li>
                <li><a>免费学院7777777</a></li>
                <li><a>免费学院88888888</a></li>
                <li><a>免费学院999999999</a></li>
                <li><a>免费学院10</a></li>
                <li><a>免费学院11</a></li>
                <li><a>免费学院12</a></li>
                <li><a>免费学院13</a></li>
                <li><a>免费学院14</a></li>
                <li><a>免费学院15</a></li>
            </ul>
        </div>
    </div>
</nav>
<nav class="nav1">
    <div id="wrapper1">
        <div id="scroller1">
            <ul class="category_nav1">
                <li>
                    <div class="search">
                        <div class="searchBox">
                            <input type="text"/>
                            <span>搜索</span>
                        </div>
                    </div>
                    <img src="image/kechenging2.png" style="width:100%;height: 3.4rem;">
                    <div class="lines">
                        <a href="eliteCoach.html">
                            <div class="line">
                                <img class="img1" src="image/kechenging3.png">
                                <div class="img1R">
                                    <div class="tit">企业订购计划1</div>
                                    <div class="user">教头：李文秀</div>
                                    <div class="null"></div>
                                    <div class="price">￥100.00</div>
                                    <div class="data">2017-02-05</div>
                                </div>
                            </div>
                        </a>
                        <a href="eliteCoach.html">
                            <div class="line">
                                <img class="img1" src="image/kechenging3.png">
                                <div class="img1R">
                                    <div class="tit">企业订购计划1</div>
                                    <div class="user">教头：李文秀</div>
                                    <div class="null"></div>
                                    <div class="price">￥100.00</div>
                                    <div class="data">2017-02-05</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </li><li>
                <div class="search">
                    <div class="searchBox">
                        <input type="text"/>
                        <span>搜索</span>
                    </div>
                </div>
                <img src="image/kechenging2.png" style="width:100%;height: 3.4rem;">
                <div class="lines">
                    <a href="eliteCoach.html">
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划2</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                    <a href="eliteCoach.html">
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划2</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                </div>
            </li><li>
                <div class="search">
                    <div class="searchBox">
                        <input type="text"/>
                        <span>搜索</span>
                    </div>
                </div>
                <img src="image/kechenging2.png" style="width:100%;height: 3.4rem;">
                <div class="lines">
                    <a href="eliteCoach.html">
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划3</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                    <a href="eliteCoach.html">
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划3</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                </div>
            </li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li>
            </ul>
        </div>
    </div>
</nav>
</body>
<script src="js/jquery.min.js" type="text/javascript" ></script>
<script >
    $(function () {
        var r1 = "rgb(0, 0, 0)";
        var r2 = "rgb(255, 164, 47)";
        function splitRGB(rgb) {return rgb.substr(4,rgb.length-5).split(', ')}
        var arrPreRGB = splitRGB(r1);
        var arrCurRGB = splitRGB(r2);
        function setRGB(n255,direction) {
            var add0 = ((Math.abs(arrCurRGB[0]-arrPreRGB[0]))/255)*n255;
            var add1 = ((Math.abs(arrCurRGB[1]-arrPreRGB[1]))/255)*n255;
            var add2 = ((Math.abs(arrCurRGB[2]-arrPreRGB[2]))/255)*n255;
            if (direction>0){return "rgb("+parseInt(arrPreRGB[0]+add0)+", "+parseInt(arrPreRGB[1]+add1)+", "+parseInt(arrPreRGB[2]+add2)+")";}
            if (direction<0){return "rgb("+parseInt(arrCurRGB[0]-add0)+", "+parseInt(arrCurRGB[1]-add1)+", "+parseInt(arrCurRGB[2]-add2)+")";}
        }
        function changed(pre,prePar,curPar) {
            return Math.abs((pre/prePar)*curPar);
        }


        var category_nav = $(".category_nav");
        var all_width = category_nav["0"].scrollWidth;
        var all_width1 = $("body").width();
        var scroller = $('#scroller');
        var scroller1_li = $('#scroller1 .category_nav1>li');
        scroller.css({
            'width':all_width + 'px'
        })
        scroller1_li.css({
            'width':all_width1 + 'px'
        })
        var myscroll=new IScroll("#wrapper",{
//            mouseWheel: true,
            disablePointer: true,
//            disableTouch:false,
//            disableMouse:false,
            scrollX: true,
            scrollY: false,
            hScrollbar:false,
            vScrollbar : false,
            vScroll:true,
            click : true,
            deceleration:0.001,
        })
        var myscroll1=new IScroll("#wrapper1",{
            probeType:3,
//            bounce:false,
            disablePointer: true,
            disableTouch:false,
//            bounce:false,             //弹动效果
//            deceleration:0,
            scrollX: true,
            scrollY: false,
            hScrollbar:false,
            vScrollbar : false,
            vScroll:false,
            click : true,
            snapThreshold:0.4,
            snap : 'li',
            momentum:false,           //惯性
            deceleration:0.00001,
            resizePolling:60
        })
        function initActive(x1) {
            category_nav.children("li").removeClass("active").children("a").css({"color":x1})
        }
        function changeColor(index,color) {
            category_nav.children("li").eq(index).children("a").css({"color":color});
        }
        function addActive(index) {
            category_nav.children("li").eq(index).addClass("active");
        }
        function centerColor(index,offset,colorChange,directionX) {                         // index:0-n     offset 0的偏移量     directionX:-1/1
            var init = index;
            if(init<0){
                init=0;
            }else if(init>14){
                init=14;
            }else{}
            initActive("#000");
            addActive(init-directionX);
            changeColor(init-directionX,setRGB(colorChange,-directionX*directionX));
            changeColor(init,setRGB(colorChange,directionX*directionX));
            console.log(init)
            myscroll.scrollToElement(document.querySelector('#scroller li:nth-child('+(init+1-directionX)+')'),500,offset,true);
            myscroll.refresh();
        }
        var myscrollOffset = (all_width1/2)-(category_nav.children("li").eq(0).width()/2);
        category_nav.on("click","li",function () {
            centerColor($(this).index(),-myscrollOffset,0,0);
            initActive("#000")
            changeColor($(this).index(),"#ffa42f");
            myscroll1.goToPage($(this).index(),0,0)
        })
        myscroll1.on("flick",function (e) {
            console.log("flick")
            centerColor(myscroll1.currentPage.pageX+myscroll1.directionX,-myscrollOffset,0,myscroll1.directionX);
            initActive("#000");
            changeColor(myscroll1.currentPage.pageX,"#ffa42f")
        })
        myscroll1.on("scrollMove",function () {                               //currentPage.pageX选中元素的index（0-n)
            console.log("scrollMove");
            myscrollOffsetAdded = (this.x-myscroll1X)*myscrollN;   //0 的实时偏移
            var colorAddedN = parseInt(Math.abs((this.x-myscroll1X)/(all_width1/255)));
            centerColor(myscroll1.currentPage.pageX+myscroll1.directionX,(-myscrollOffsetAdded)-myscrollOffset,colorAddedN,myscroll1.directionX);////
        })
        $(".nav1")["0"].addEventListener("touchend",function (e) {
            console.log("touchend")
            if(Math.abs(myscroll1.distX)>myscroll1.snapThresholdX){
                if(myscroll1.directionX>0){centerColor(myscroll1.currentPage.pageX+myscroll1.directionX,-myscrollOffset+(category_nav.children("li").eq(myscroll1.currentPage.pageX+myscroll1.directionX-1).width()),255,myscroll1.directionX)};
                if(myscroll1.directionX<0){centerColor(myscroll1.currentPage.pageX-1,-myscrollOffset-(category_nav.children("li").eq(myscroll1.currentPage.pageX+1).width()),255,myscroll1.directionX);}
            }else{
                if(myscroll1.directionX>0){centerColor(myscroll1.currentPage.pageX,-myscrollOffset,255,0)};
                if(myscroll1.directionX<0){centerColor(myscroll1.currentPage.pageX,-myscrollOffset,255,0);}
                changeColor(myscroll1.currentPage.pageX,"#ffa42f");
            }
        })
        myscroll1.on("scrollStart",function () {
            myscroll1X = this.x;                                              // 1的X值 正
            console.log(this.currentPage.pageX)                                        //currentPage.pageX：0-n;
            myscrollOffset = (all_width1-category_nav.children("li").eq(this.currentPage.pageX).width())/2;               //‘正中位置时的’偏移量偏移
            myscrollN = category_nav.children("li").eq(this.currentPage.pageX).width()/all_width1;//比例关系
        })
    })
</script>
</html>