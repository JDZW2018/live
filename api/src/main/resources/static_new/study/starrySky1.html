<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <base target="_self" href="http://192.168.1.108:90/ws_project/jiaotouxueyuan/">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,initial-scale=1.0, user-scalable=no" />
    <link href="css/reset.css" rel="stylesheet" type="text/css"/>
    <link href="css/videoCourseList.css" rel="stylesheet" type="text/css"/>
    <script src="js/conform.js" type="text/javascript"></script>
    <script src="js/iScroll-5.1.2.js"></script>
    <!--<script src="js/iscroll-probe.js"></script>-->
    <title>视频</title>
    <style>

    </style>
</head>
<body>
<nav class="nav">
    <div id="wrapper">
        <div id="scroller">
            <ul class="category_nav">
                <li><a>免1</a></li>
                <li><a>创业2</a></li>
                <li><a>管理学3</a></li>
                <li><a>父母学院4</a></li>
                <li><a>免5</a></li>
                <li><a>免费6</a></li>
                <li><a>免费学7</a></li>
                <li><a>免费学院8</a></li>
                <li><a>免9</a></li>
                <li><a>免费0</a></li>
                <li><a>免费学1</a></li>
                <li><a>免费学院2</a></li>
                <li><a>免3</a></li>
                <li><a>免费4</a></li>
                <li><a>免费学5</a></li>
            </ul>
        </div>
    </div>
</nav>
<nav class="nav1">
    <div id="wrapper1">
        <div id="scroller1">
            <ul class="category_nav1">
                <li>
                    <div class="search">
                        <div class="searchBox">
                            <input type="text"/>
                            <span>搜索</span>
                        </div>
                    </div>
                    <img src="image/kechenging2.png" style="width:100%;height: 3.4rem;">
                    <div class="lines">
                        <a><!-- href="eliteCoach.html"-->
                            <div class="line">
                                <img class="img1" src="image/kechenging3.png">
                                <div class="img1R">
                                    <div class="tit">企业订购计划1</div>
                                    <div class="user">教头：李文秀</div>
                                    <div class="null"></div>
                                    <div class="price">￥100.00</div>
                                    <div class="data">2017-02-05</div>
                                </div>
                            </div>
                        </a>
                        <a>
                            <div class="line">
                                <img class="img1" src="image/kechenging3.png">
                                <div class="img1R">
                                    <div class="tit">企业订购计划1</div>
                                    <div class="user">教头：李文秀</div>
                                    <div class="null"></div>
                                    <div class="price">￥100.00</div>
                                    <div class="data">2017-02-05</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </li><li>
                <div class="search">
                    <div class="searchBox">
                        <input type="text"/>
                        <span>搜索</span>
                    </div>
                </div>
                <img src="image/kechenging2.png" style="width:100%;height: 3.4rem;">
                <div class="lines">
                    <a>
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划2</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                    <a>
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划2</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                </div>
            </li><li>
                <div class="search">
                    <div class="searchBox">
                        <input type="text"/>
                        <span>搜索</span>
                    </div>
                </div>
                <img src="image/kechenging2.png" style="width:100%;height: 3.4rem;">
                <div class="lines">
                    <a>
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划3</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                    <a >
                        <div class="line">
                            <img class="img1" src="image/kechenging3.png">
                            <div class="img1R">
                                <div class="tit">企业订购计划3</div>
                                <div class="user">教头：李文秀</div>
                                <div class="null"></div>
                                <div class="price">￥100.00</div>
                                <div class="data">2017-02-05</div>
                            </div>
                        </div>
                    </a>
                </div>
            </li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li>
            </ul>
        </div>
    </div>
</nav>
</body>
<script src="js/jquery.min.js" type="text/javascript" ></script>
<script >
    $(function () {
        function splitRGB(rgb) {return rgb.substr(4,rgb.length-5).split(', ')}
        var r1 = "rgb(0, 0, 0)";
        var r2 = "rgb(255, 164, 47)";
        var arrPreRGB = splitRGB(r1);
        var arrCurRGB = splitRGB(r2);
        var r1_1 = "rgb(255, 255, 255)";
        var r2_1 = "rgb(255, 164, 47)";
        var arrPreRGB_1 = splitRGB(r1_1);
        var arrCurRGB_1 = splitRGB(r2_1);
        function setRGB(n255,direction) {
            var add0 = ((Math.abs(arrCurRGB[0]-arrPreRGB[0]))/255)*n255;
            var add1 = ((Math.abs(arrCurRGB[1]-arrPreRGB[1]))/255)*n255;
            var add2 = ((Math.abs(arrCurRGB[2]-arrPreRGB[2]))/255)*n255;
            var add0_1 = parseInt(((Math.abs(arrCurRGB_1[0]-arrPreRGB_1[0]))/255)*n255);
            var add1_1 = parseInt(((Math.abs(arrCurRGB_1[1]-arrPreRGB_1[1]))/255)*n255);
            var add2_1 = parseInt(((Math.abs(arrCurRGB_1[2]-arrPreRGB_1[2]))/255)*n255);
            console.log(parseInt(arrPreRGB_1[0]-add0_1))
            if (direction>0){return ["rgb("+parseInt(arrPreRGB[0]+add0)+", "+parseInt(arrPreRGB[1]+add1)+", "+parseInt(arrPreRGB[2]+add2)+")", "rgb("+parseInt(parseInt(arrPreRGB_1[0])-10)+", "+parseInt(parseInt(arrPreRGB_1[1])-add1_1)+", "+parseInt(parseInt(arrPreRGB_1[2])-add2_1)+")"];}
            if (direction<0){return ["rgb("+parseInt(arrCurRGB[0]-add0)+", "+parseInt(arrCurRGB[1]-add1)+", "+parseInt(arrCurRGB[2]-add2)+")","rgb("+parseInt(parseInt(arrCurRGB_1[0])+add0_1)+", "+parseInt(parseInt(arrCurRGB_1[1])+add1_1)+", "+parseInt(parseInt(arrCurRGB_1[2])+add2_1)+")"];}
        }
        function changed(pre,prePar,curPar) {
            return Math.abs((pre/prePar)*curPar);
        }


        var category_nav = $(".category_nav");
        var all_width = category_nav["0"].scrollWidth;
        var all_width1 = $("body").width();
        var scroller = $('#scroller');
        var scroller1_li = $('#scroller1 .category_nav1>li');
        scroller.css({
            'width':all_width + 'px'
        })
        scroller1_li.css({
            'width':all_width1 + 'px'
        })
        var myscroll=new IScroll("#wrapper",{
//            mouseWheel: true,
            disablePointer: true,
//            disableTouch:false,
//            disableMouse:false,
            scrollX: true,
            scrollY: false,
            hScrollbar:false,
            vScrollbar : false,
            vScroll:true,
            click : true,
            deceleration:0.001,
        })
        var myscroll1=new IScroll("#wrapper1",{
            probeType:3,
//            bounce:false,
            disablePointer: true,
            disableTouch:false,
//            bounce:false,             //弹动效果
//            deceleration:0,
            scrollX: true,
            scrollY: false,
            hScrollbar:false,
            vScrollbar : false,
            vScroll:false,
            click : true,
            snapThreshold:0.4,
            snap : 'li',
            momentum:false,           //惯性
            deceleration:0.00001,
            resizePolling:60
        })
        function initActive(x1) {
            category_nav.children("li").removeClass("active").children("a").css({"color":x1})
            category_nav.children("li").css({"border-bottom":"0.01rem solid #fff"})
        }
        function changeColor(index,color) {
            category_nav.children("li").eq(index).children("a").css({"color":color[0]});
            category_nav.children("li").eq(index).css({"border-bottom":"0.01rem solid "+color[1]});
        }
        function addActive(index) {
            category_nav.children("li").eq(index).addClass("active");
        }
        function myscrollToElement(index,l) {
            myscroll.scrollToElement(document.querySelector('#scroller li:nth-child('+(index+1)+')'),500,l,true);
        }
        var myscrollOffset = (all_width1/2)-(category_nav.children("li").eq(0).width()/2);
        category_nav.on("click","li",function () {
            initActive("#000")
            changeColor($(this).index(),[r2,r2_1]);
            myscroll1.goToPage($(this).index(),0,0)
        })
        myscroll1.on("flick",function (e) {
            myscrollToElement(myscroll1.currentPage.pageX,true);                          //this.currentPage.pageX = target元素的index
            initActive("#000");
            changeColor(myscroll1.currentPage.pageX,[r2,r2_1]);
            //////////////////css
        })
        myscroll1.on("scrollMove",function () {                               //currentPage.pageX选中元素的index（0-n)
                myscrollOffsetAdded = (Math.abs(this.x)-myscroll1X)*myscrollN;                           //  0的 实时 偏移
                var colorAddedN = parseInt(Math.abs((Math.abs(this.x)-myscroll1X)/(all_width1/255)));
                myscrollToElement(myscroll1.currentPage.pageX+myscroll1.directionX,-myscrollOffset-myscroll1.directionX*((myscrollCurWidth/2+myscrollNextWidth/2)-myscroll1.directionX*myscrollOffsetAdded));
                changeColor(myscroll1.currentPage.pageX,setRGB(colorAddedN,-1));
                changeColor(myscroll1.currentPage.pageX+myscroll1.directionX,setRGB(colorAddedN,1));
        })
        $(".nav1")["0"].addEventListener("touchend",function (e) {
                if(Math.abs(myscroll1.distX)>myscroll1.snapThresholdX){
                    myscrollToElement(myscroll1.currentPage.pageX+myscroll1.directionX,-myscrollOffset);
                    changeColor(myscroll1.currentPage.pageX,setRGB(255,-1));
                    changeColor(myscroll1.currentPage.pageX+myscroll1.directionX,setRGB(255,1));
                }else{
                    myscrollToElement(myscroll1.currentPage.pageX,true);
                    initActive("#000")
                    changeColor(myscroll1.currentPage.pageX,setRGB(255,1));
//                    changeColor(myscroll1.currentPage.pageX+myscroll1.directionX,setRGB(255,-1));
                }
        })
        myscroll1.on("scrollStart",function () {
                initActive("#000");
                myscroll1X = Math.abs(this.x);                                              // 1的X值 正
                myscrollOffset = (all_width1-category_nav.children("li").eq(this.currentPage.pageX+this.directionX).width())/2;               //‘正中位置时的’偏移量偏移
                myscrollCurWidth = category_nav.children("li").eq(this.currentPage.pageX).width();
                myscrollNextWidth = category_nav.children("li").eq(this.currentPage.pageX+this.directionX).width();
                myscrollN = Math.abs((myscrollCurWidth/2+myscrollNextWidth/2)/all_width1);                //比例关系
        })
    })
</script>
</html>